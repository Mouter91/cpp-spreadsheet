# üìä Spreadsheet Formula Engine in C++

üßÆ **–ú–∏–Ω–∏-—Ç–∞–±–ª–∏—á–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –Ω–∞ C++**, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π —Ñ–æ—Ä–º—É–ª—ã, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫. –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–±–ª–∏–∂–µ–Ω –ø–æ –¥—É—Ö—É –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ Excel/Google Sheets, –Ω–æ –Ω–∞–ø–∏—Å–∞–Ω —Å –Ω—É–ª—è.

---

## üîß –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚ú® **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:**

- üìú –°—Ç—Ä–æ–∫–∏ (–≤–∫–ª—é—á–∞—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ `'`)
- üî¢ –ß–∏—Å–ª–∞ (—Ü–µ–ª—ã–µ –∏ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ)
- üß† –§–æ—Ä–º—É–ª—ã (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `=`)

‚öôÔ∏è **–§–æ—Ä–º—É–ª—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç:**

- –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫—É: `+`, `-`, `*`, `/`
- –°–∫–æ–±–∫–∏: `()`
- –°—Å—ã–ª–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ —è—á–µ–π–∫–∏: `=A1 + B2 * (C3 - 4)`
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

üõë **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**

- `#REF!` ‚Äî –Ω–µ–≤–µ—Ä–Ω–∞—è —Å—Å—ã–ª–∫–∞
- `#VALUE!` ‚Äî –æ—à–∏–±–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- `#ARITHM!` ‚Äî –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –§–∞–π–ª | –†–æ–ª—å |
|------|------|
| `sheet.h`, `cell.h` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü–µ–π –∏ —è—á–µ–π–∫–∞–º–∏ |
| `formula.h/.cpp` | –ü–∞—Ä—Å–∏–Ω–≥ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª |
| `FormulaAST.h` | –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ |
| `common.h` | –¢–∏–ø—ã –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è |
| `Formula.g4` | ANTLR-–≥—Ä–∞–º–º–∞—Ç–∏–∫–∞ —Ñ–æ—Ä–º—É–ª |
| `main.cpp` | –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ |

---

## üí° –ü—Ä–∏–º–µ—Ä—ã —Ñ–æ—Ä–º—É–ª

| –§–æ—Ä–º—É–ª–∞     | –†–µ–∑—É–ª—å—Ç–∞—Ç      |
|-------------|----------------|
| `=1+2`      | `3`            |
| `='Text'`   | `Text`         |
| `=A1/B2`    | –°—Å—ã–ª–∫–∞         |
| `=1/0`      | `#ARITHM!`     |
| `=BAD99999` | `#REF!`        |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
g++ -std=c++17 -o spreadsheet main.cpp formula.cpp
./spreadsheet
```

üîÅ –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `main.cpp`, —á—Ç–æ–±—ã –≤–≤–æ–¥–∏—Ç—å –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π **C++17**
- –ó–∞–≥–æ–ª–æ–≤–∫–∏:
  - `<variant>`, `<optional>`, `<map>`, `<vector>`, `<sstream>`, `<stdexcept>`, `<cassert>`
- –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞:
  - `cell.h`, `sheet.h`, `formula.h`, `FormulaAST.h`, `common.h`, `Formula.g4`

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤ –¥–≤—É—Ö —Å–ª–æ–≤–∞—Ö

1. **Sheet** —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü–µ–π.
2. **Cell** —Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—Å—Ç –∏–ª–∏ —Ñ–æ—Ä–º—É–ª—É.
3. **Formula** –ø–∞—Ä—Å–∏—Ç—Å—è –≤ AST —á–µ—Ä–µ–∑ `FormulaAST`.
4. –ö—ç—à —Ñ–æ—Ä–º—É–ª —É—Å–∫–æ—Ä—è–µ—Ç –ø–µ—Ä–µ—Å—á—ë—Ç.
5. –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —è—á–µ–π–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

> üìò –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥–æ–π–¥—ë—Ç –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–æ–≤ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É –¥–∞–Ω–Ω—ã–º–∏.